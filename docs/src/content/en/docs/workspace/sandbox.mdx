---
title: "Sandbox | Workspace"
description: Configure sandbox providers to give agents command execution capabilities.
packages:
  - "@mastra/core"
---

# Sandbox

**Added in:** `@mastra/core@1.1.0`

Sandbox providers give agents the ability to execute shell commands. When you configure a sandbox on a workspace, agents can run commands as part of their tasks.

A sandbox provider executes commands in a controlled environment:

- **Command execution** - Run shell commands with arguments
- **Background processes** - Spawn long-running processes like dev servers and watchers
- **Working directory** - Commands run from a specific directory
- **Environment variables** - Control what variables are available
- **Timeouts** - Prevent long-running commands from hanging
- **Isolation** - Optional OS-level sandboxing for security

When you assign a workspace with a sandbox to an agent, Mastra automatically includes the `execute_command` tool in the agent's toolset.

## Supported providers

Available providers:

- [`LocalSandbox`](/reference/workspace/local-sandbox) - Executes commands on the local machine
- [`E2BSandbox`](/reference/workspace/e2b-sandbox) - Executes commands in isolated E2B cloud sandboxes

## Basic usage

Create a workspace with a sandbox and assign it to an agent. The agent can then execute shell commands:

```typescript title="src/mastra/agents/dev-agent.ts"
import { Agent } from '@mastra/core/agent'
import { Workspace, LocalFilesystem, LocalSandbox } from '@mastra/core/workspace'

const workspace = new Workspace({
  filesystem: new LocalFilesystem({
    basePath: './workspace',
  }),
  sandbox: new LocalSandbox({
    workingDirectory: './workspace',
  }),
})

const agent = new Agent({
  id: 'dev-agent',
  model: 'openai/gpt-4o',
  instructions: 'You are a helpful development assistant.',
  workspace,
})

// The agent now has the execute_command tool available
const response = await agent.generate('Run `ls -la` in the workspace directory')
```

See [`LocalSandbox` reference](/reference/workspace/local-sandbox) for configuration options including environment isolation and native OS sandboxing.

## Background processes

Sandbox providers can also spawn long-running background processes. Use background processes for dev servers, file watchers, REPLs, and other tasks that run continuously:

```typescript
const handle = await sandbox.processes.spawn('npm run dev', {
  onStdout: data => console.log(data),
})

console.log(handle.pid)
await handle.sendStdin('input\n')
await handle.kill()
```

See [background processes](/docs/workspace/processes) for a full guide, or the [`SandboxProcessManager` reference](/reference/workspace/process-manager) for API details.

## Agent tools

When you configure a sandbox on a workspace, agents receive the `execute_command` tool for running shell commands. When the sandbox includes a process manager, agents also get:

- **`execute_command`** with `background: true` - Start a long-running command and get back a PID
- **`get_process_output`** - Check stdout, stderr, and status of a background process by PID
- **`kill_process`** - Stop a background process by PID

These tools are registered automatically when `sandbox.processes` is available. See [workspace class reference](/reference/workspace/workspace-class#sandbox-tools) for the full list.

## Related

- [Background processes](/docs/workspace/processes)
- [`SandboxProcessManager` reference](/reference/workspace/process-manager)
- [`LocalSandbox` reference](/reference/workspace/local-sandbox)
- [`E2BSandbox` reference](/reference/workspace/e2b-sandbox)
- [Workspace overview](/docs/workspace/overview)
- [Filesystem](/docs/workspace/filesystem)
